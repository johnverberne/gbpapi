
https://github.com/nginx-proxy/docker-letsencrypt-nginx-proxy-companion

docker run --detach \
    --name nginx-proxy \
    --publish 80:80 \
    --publish 443:443 \
    --volume /etc/nginx/certs \
    --volume /etc/nginx/vhost.d \
    --volume /usr/share/nginx/html \
    --volume /var/run/docker.sock:/tmp/docker.sock:ro \
    jwilder/nginx-proxy


docker run --detach \
    --name nginx-proxy-letsencrypt \
    --volumes-from nginx-proxy \
    --volume /var/run/docker.sock:/var/run/docker.sock:ro \
    --env "john.verberne@gmail.com" \
    jrcs/letsencrypt-nginx-proxy-companion

--- example we do not use we build ower own ----

docker run --detach \
    --name your-proxied-app \
    --env "VIRTUAL_HOST=gbp.captainjohn.nl" \
    --env "VIRTUAL_PORT=8081" \
    --volume /etc/nginx/vhost.d \
    --env "LETSENCRYPT_HOST=gbp.captainjohn.nl" \
    nginx


--- build own api-proxy ----

[build.sh]
#!/bin/bash
#build latest version
docker build -t gbp-proxy:latest .

[Dockerfile]
FROM nginx:latest

COPY nginx.conf /etc/nginx/nginx.conf

[nginx.conf]
worker_processes 1;

events { worker_connections 1024; }

http {

    log_format compression '$remote_addr - $remote_user [$time_local] '
        '"$request" $status $upstream_addr '
        '"$http_referer" "$http_user_agent" "$gzip_ratio"';


    server {
        listen 80;
        access_log /var/log/nginx/access.log compression;

        location / {
            proxy_pass         http://192.168.168.15:8080/;
            proxy_redirect     off;
            proxy_set_header   Host $host;
            proxy_set_header   X-Real-IP $remote_addr;
            proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header   X-Forwarded-Host $server_name;
        }
    }
}



[run.sh]
#!/bin/bash
docker run --rm \
  --name api-proxy \
  --env "VIRTUAL_HOST=gbp.captainjohn.nl" \
  --env "LETSENCRYPT_HOST=gbp.captainjohn.nl" \
  gbp-proxy:latest



